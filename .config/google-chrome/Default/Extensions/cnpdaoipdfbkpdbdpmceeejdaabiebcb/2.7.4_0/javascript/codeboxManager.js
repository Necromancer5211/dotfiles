var CodeBoxManager={saveSnippet:function(a,b,c,d,e,f,g,h){var i={_csrf:f,title:c,code:b,url:d,tags:e.concat(this.getHostnameTag())};$.ajax({type:"POST",url:codotaHost+"/user-snippet/",data:i,dataType:"json"}).done(function(a){h(null,a)}).fail(function(a){403==a.status?(g(),chrome.extension.onMessage.addListener(function a(b){chrome.extension.onMessage.removeListener(a),"authentication"==b.type&&"success"==b.status?(MixpanelManager.alias(b.userIdentifier),$.post(codotaHost+"/user-snippet/",i).done(function(a){console.log("snippet saved!"),h(null,a)}).fail(function(a){console.log("snippet fail!"),h(a.responseText)})):"authentication"==b.type&&"failed"==b.status&&h("Login cancelled!")}),CodeBoxManager.login()):h(a.responseText)})},login:function(){$.fancybox({href:codotaHost+"/codebox/splash",width:1e3,height:600,padding:0,autoSize:!1,type:"iframe",afterClose:function(){chrome.runtime.sendMessage({type:"authenticationFailed"})}})},shareSnippet:function(a){$.fancybox({href:"about:blank",width:1002,height:421,padding:0,autoSize:!1,type:"iframe"}),$.getJSON(codotaHost+"/api/postToken").done(function(b){var c=$(".fancybox-iframe").attr("name"),d=codotaHost+"/shareSnippet/"+a.attr("data-snippet-id");$form=$("form#codebox-form"),$form.attr({action:d,target:c,"accept-charset":"UTF-8"}),$form.append($('<input type="hidden" name="code"/>').val(a.attr("data-original-code"))),$form.append($('<input type="hidden" name="url"/>').val(window.location.href)),$form.append($('<input type="hidden" name="title"/>').val(window.document.title)),$form.append($('<input type="hidden" name="_csrf"/>').val(b.csrfToken)),$form.submit(),$form.empty()})},getHostnameTag:function(){return window.location.hostname}};