function isCSPHeader(a){return"CONTENT-SECURITY-POLICY"==a||"X-WEBKIT-CSP"==a}function navigateToUrl(a){chrome.tabs.getSelected(null,function(b){chrome.tabs.update(b.id,{url:a,active:!0})})}function copyToClipboard(a){var b=document.createElement("textarea");document.body.appendChild(b),b.value=a,b.focus(),b.select(),document.execCommand("Copy"),b.remove()}chrome.runtime.onInstalled.addListener(function(a){if("install"==a.reason){const b=chrome.runtime.getManifest();chrome.tabs.create({url:"https://www.codota.com/chrome?ver="+b.version+"&name="+encodeURIComponent(b.name),active:!0})}}),chrome.runtime.onMessage.addListener(function(a,b,c){switch(console.log("Message to background: %j from tab: %s",a,b.tab.id),a.type){case"authenticated":chrome.tabs.query({},function(b){for(var c=0;c<b.length;c++)chrome.tabs.sendMessage(b[c].id,{type:"authentication",userIdentifier:a.userIdentifier,status:"success"})});break;case"authenticationFailed":chrome.tabs.query({active:!0,currentWindow:!0},function(a){chrome.tabs.sendMessage(a[0].id,{type:"authentication",status:"failed"})});case"copyToClipboard":copyToClipboard(a.text);break;case"shareSnippet":"close"==a.action&&chrome.tabs.query({active:!0,currentWindow:!0},function(a){chrome.tabs.sendMessage(a[0].id,{type:"close-fancybox"})});break;default:c({})}}),chrome.webRequest.onHeadersReceived.addListener(function(a){for(i=0;i<a.responseHeaders.length;i++)if(isCSPHeader(a.responseHeaders[i].name.toUpperCase())){var b=a.responseHeaders[i].value;b=b.replace("frame-src","frame-src *.codota.com"),a.responseHeaders[i].value=b}return{responseHeaders:a.responseHeaders}},{urls:["https://github.com/*"],types:["main_frame"]},["blocking","responseHeaders"]),chrome.omnibox.setDefaultSuggestion({description:"Search Codota for <match>%s</match>"}),chrome.omnibox.onInputChanged.addListener(function(a,b){a&&a.length>0&&$.ajax({url:"http://www.codota.com/api/search/typeahead/"+a,dataType:"json",error:function(a){},success:function(a){var c=[];for(var d in a){var e=a[d].split(":"),f={};e.length>1?(f.content="task:"+e[0],f.description=e[1]):(f.content=e[0],f.description=e[0]),c.push(f)}b(c)}})}),chrome.omnibox.onInputEntered.addListener(function(a){var b=a.split(":");navigateToUrl("task"==b[0]?"http://www.codota.com/taskDetails?task="+encodeURIComponent(b[1])+"&source=omnibox":"http://www.codota.com/doSearchScenarios?searchQuery="+encodeURIComponent(a)+"&source=omnibox")});