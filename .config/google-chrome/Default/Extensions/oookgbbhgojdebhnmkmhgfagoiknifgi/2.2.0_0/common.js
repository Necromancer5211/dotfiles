/*! Unspoiler - v2.2.0 - 2014-01-23 */function setSyncStatus(a){chrome.storage.sync.set({isSyncNeeded:a},function(){})}var sendFilterRequest=function(a,b){var c={search:a};b?chrome.tabs.sendMessage(b,c):chrome.tabs.query({active:!0},function(a){for(var b in a){var d=a[b];chrome.tabs.sendMessage(d.id,c)}})},getTags=function(a){chrome.storage.sync.get("filters",function(b){b.filters||(b.filters=[]),a(b.filters)})},getSpoilers=function(a){chrome.storage.sync.get("spoilers",function(b){b.spoilers||(b.spoilers=[]),a(b.spoilers)})},getWhitesites=function(a){chrome.storage.sync.get("whitesites",function(b){b.whitesites||(b.whitesites=[]),a(b.whitesites)})},saveTag=function(a,b){a&&getTags(function(c){var d=c.length;d||(c=[],d=0);for(var e=!1,f=0;d>f;f+=1)if(c[f].toLowerCase()==a.toLowerCase()){e=!0;break}e||c.push(a),chrome.storage.sync.set({filters:c},function(){setSyncStatus(!0);var c=new Array(a);sendFilterRequest(c),b&&"function"==typeof b&&b({isSuccess:!e,text:a})})})};