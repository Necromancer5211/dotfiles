/*! Unspoiler - v2.2.0 - 2014-01-23 */function addTag(){var a=$("#spoiler-input").val();$("#spoiler-input").val(""),saveTag(a,function(a){a.isSuccess&&($("#tag-list").append('<li><span class="remove">x</span><span class="text">'+a.text+"</span></li>"),bindRemoveTag())})}function addWhitesite(){var a=$("#whitelist-input").val();$("#whitelist-input").val(""),saveWhiteSite(a,function(a){a.isSuccess&&($("#white-list").append('<li><span class="remove">x</span><span class="text">'+a.text+"</span></li>"),bindRemoveWhitesite())})}function deleteWhitesite(){var a=$(this).parent(),b=a.find(".text").text();a.remove(),getWhitesites(function(a){var c=a.indexOf(b);c>-1&&a.splice(c,1),chrome.storage.sync.set({whitesites:a},function(){})})}function pageLoad(){chrome.storage.sync.get(["filters","showFlag","spoilers","whitesites"],function(a){var b=a.filters,c=a.spoilers,d=a.whitesites,e="true"===a.showFlag;null==a.showFlag&&(e=!0),$('input[name="warningflag"][value='+e+"]").prop("checked",!0);for(var f=b?b.length:0,g=0;f>g;g+=1){var h=b[g];$("#tag-list").append('<li><span class="remove">x</span><span class="text">'+h+"</span></li>")}for(var i=c?c.length:0,j=0;i>j;j+=1){var k=c[j];$("#spoilers-list").append('<li><span class="remove">x</span><span class="text">'+k.title+"</span></li>")}for(var l=d?d.length:0,m=0;l>m;m+=1){var n=d[m];$("#white-list").append('<li><span class="remove">x</span><span class="text">'+n+"</span></li>")}bindRemoveTag(),bindRemoveWhitesite()});var a=chrome.extension.getURL("options.html");$("#options-link").prop("href",a),$("#unspoil-button").on("click",addTag),$("#whitelist-button").on("click",addWhitesite),$("#spoiler-input").on("keyup",function(a){13===a.keyCode&&addTag()}),$('input[name="warningflag"]').on("click",saveShowFlag)}function saveWhiteSite(a,b){getWhitesites(function(c){var d=c.length;d||(c=[],d=0);for(var e=!1,f=0;d>f;f+=1)if(c[f].toLowerCase()==a.toLowerCase()){e=!0;break}e||c.push(a),chrome.storage.sync.set({whitesites:c},function(){b&&"function"==typeof b&&b({isSuccess:!e,text:a})})})}var deleteTag=function(){var a=$(this).parent(),b=a.find(".text").text();a.remove(),chrome.storage.sync.get("filters",function(a){var c=a.filters,d=c.indexOf(b);d>=0&&c.splice(d,1),chrome.storage.sync.set({filters:c},function(){setSyncStatus(!0)})})},bindRemoveTag=function(){$("#tag-list .remove").off("click").on("click",deleteTag)},bindRemoveWhitesite=function(){$("#white-list .remove").off("click").on("click",deleteWhitesite)},saveShowFlag=function(){var a=$(this).val();chrome.storage.sync.set({showFlag:a},function(){})};$(pageLoad);